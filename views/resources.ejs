<%- include('partials/header') %>
<%- include('partials/messages') %>
<div class='d-flex justify-content-between align-items-center mb-3'>
  <h2 data-aos='fade-down'>Resources</h2>
  <form class='d-flex' method='GET' action='/resources'>
    <input name='q' class='form-control me-2' placeholder='Search resources' value='<%= q || '' %>'>
    <select name='category' class='form-select me-2'>
      <option value=''>All</option>
      <% categories.forEach(c=>{ %>
        <option value='<%= c %>' <%= c===category? 'selected' : '' %>><%= c %></option>
      <% }) %>
    </select>
    <button class='btn btn-outline-secondary'>Search</button>
  </form>
</div>
<div class='row'>
  <% list.forEach((r,i)=>{ %>
    <div class='col-md-6 mb-3' data-aos='fade-up' data-aos-delay='<%= i*80 %>'>
      <div class='card p-3 hover-lift'>
        <h5><%= r.title %></h5>
        <small class='text-muted'>Category: <%= r.category %> â€” By <%= r.author ? r.author.name : 'Unknown' %></small>
        <div class='mt-2 text-muted'><%- r.content.substring(0,220) %>...</div>
        <a href='/resources/<%= r._id %>' class='btn btn-sm btn-primary mt-2'>Read more</a>
      </div>
    </div>
  <% }) %>
</div>
<nav aria-label='Page navigation'>
  <ul class='pagination'>
    <% for(let i=1;i<=pages;i++){ %>
      <li class='page-item <%= i===page? "active" : "" %>'><a class='page-link' href='/resources?page=<%= i %>&q=<%= q %>&category=<%= category %>'><%= i %></a></li>
    <% } %>
  </ul>
</nav>
<%- include('partials/footer') %>
