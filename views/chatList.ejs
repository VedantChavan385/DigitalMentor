<%- include('partials/header') %>
<%- include('partials/messages') %>
<div class="row">
  <div class="col-md-6">
    <h3 data-aos='fade-down'>Conversations</h3>
    <% if(conversations.length===0){ %>
      <div class='card p-3'>
        <p class='text-muted'>You have no conversations yet. Start a new chat from the list on the right.</p>
      </div>
    <% } else { %>
      <% conversations.forEach(c=>{ %>
        <a href='/messages/chat/<%= c.user._id %>' class='card p-3 mb-2 d-block text-decoration-none text-dark'>
          <strong><%= c.user.name %></strong>
          <div class='small text-muted'><%= c.lastMessage %> â€¢ <%= new Date(c.lastAt).toLocaleString() %></div>
        </a>
      <% }) %>
    <% } %>
  </div>
  <div class="col-md-6">
    <h3 data-aos='fade-down'>Start a new chat</h3>
    <% if(others.length===0){ %>
      <div class='card p-3'>No users available to chat.</div>
    <% } else { %>
      <% others.forEach(o=>{ %>
        <div class='card p-3 mb-2'>
          <div class='d-flex justify-content-between align-items-center'>
            <div>
              <strong><%= o.name %></strong>
            </div>
            <div>
              <a href='/messages/chat/<%= o._id %>' class='btn btn-sm btn-primary me-1'>Chat</a>
              <a href='/messages/chat/<%= o._id %>?autocall=1' class='btn btn-sm btn-success'>Call</a>
            </div>
          </div>
        </div>
      <% }) %>
    <% } %>
  </div>
</div>
<%- include('partials/footer') %>
